<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Daily Dose of BCA</title>

    <!-- Favicons -->
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" href="mylogo-32x32.png" sizes="32x32" type="image/png">
    <link rel="icon" href="mylogo-64x64.png" sizes="64x64" type="image/png">
    <link rel="apple-touch-icon" href="apple-touch-icon.png" sizes="180x180">
    <link rel="icon" href="icon-192.png" sizes="192x192" type="image/png">
    <link rel="icon" href="icon-512.png" sizes="512x512" type="image/png">
    <meta name="theme-color" content="#0f172a">

    <!-- Tailwind (CDN) and libs -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        // pdf.js worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

    <style>
        :root{
            --sky-blue-accent: #38bdf8;
            --bg-dark: #0f172a;
        }
        body{
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-dark);
            color: #f8fafc;
            line-height: 1.6;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Glass */
        .glass{
            background: rgba(15,23,42,0.6);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255,255,255,0.08);
            box-shadow: 0 4px 30px rgba(0,0,0,0.1);
        }
        .glass-strong{
            background: rgba(30,41,59,0.75);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(56,189,248,0.1);
        }

        /* Ambient blobs */
        .blob-cont{ position: fixed; top:0; left:0; width:100%; height:100vh; z-index:-1; overflow:hidden; pointer-events:none; }
        .blob{ position:absolute; border-radius:50%; filter: blur(80px); opacity:0.4; animation: float 10s infinite ease-in-out alternate; }
        .blob-1{ top:-10%; left:-10%; width:500px; height:500px; background:#0ea5e9; }
        .blob-2{ bottom:-10%; right:-10%; width:600px; height:600px; background:#6366f1; }
        .blob-3{ top:40%; left:40%; width:400px; height:400px; background:#0f172a; opacity:0.8; }

        @keyframes float{ 0%{ transform: translate(0,0) scale(1);} 100%{ transform: translate(30px,50px) scale(1.1);} }

        /* Content fade-in */
        .content-section{ opacity:0; transform: translateY(20px); transition: opacity .8s ease-out, transform .8s ease-out; }
        .content-section.is-visible{ opacity:1; transform: translateY(0); }

        /* Prose tweaks */
        .prose h3{ color:#38bdf8; font-weight:700; margin-top:1em; }
        .custom-scrollbar::-webkit-scrollbar{ width:6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb{ background: rgba(255,255,255,0.2); border-radius:10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover{ background: rgba(255,255,255,0.4); }

        /* Tabs */
        .tab-active{ border-bottom:2px solid #38bdf8; color:#38bdf8; text-shadow:0 0 10px rgba(56,189,248,0.4); }
        .tab-inactive{ border-bottom:2px solid transparent; color:#94a3b8; }
        .tab-inactive:hover{ color:#e2e8f0; }

        /* Mobile-first improvements */
        @media (max-width: 640px) {
            /* center header on mobile */
            header .max-w-7xl { justify-content: center !important; text-align: center !important; }
            header .flex.items-center { justify-content: center !important; width: 100%; }

            /* reduce blob intensity */
            .blob-1{ width:280px; height:280px; top:-20%; left:-20%; filter:blur(60px); opacity:0.28; }
            .blob-2{ width:340px; height:340px; bottom:-20%; right:-20%; filter:blur(60px); opacity:0.28; }
            .blob-3{ display:none; }

            header{ padding:0.4rem 0; }
            header .text-2xl{ font-size:1.05rem; }

            /* cards stack and spacing */
            #subject-cards-container{ grid-template-columns: 1fr !important; gap:14px !important; }
            #subject-cards-container a{ padding:1rem !important; border-radius:1rem !important; }
            #subject-cards-container h2{ font-size:1.05rem !important; }

            /* compact AI companion */
            .glass-strong .p-6 { padding:0.9rem !important; }
            .glass-strong .border-b { padding-bottom:0.6rem; }

            /* tabs pill buttons */
            .glass-strong .flex.bg-black\\/20 { padding:0.25rem; gap:0.25rem; }
            #tab-quick, #tab-chat { padding:0.5rem 0.75rem; font-size:0.86rem; border-radius:0.75rem; }

            /* quick tools stack */
            #view-quick .grid { grid-template-columns: 1fr !important; }
            #quick-topic { font-size:1rem; padding:0.9rem; }

            /* chat area */
            #view-chat { min-height:360px !important; }
            #chat-history { padding-top:6rem !important; }
            #chat-input { padding:0.75rem 3rem 0.75rem 1rem !important; font-size:0.98rem; }
            #chat-history .glass, #chat-history .bg-gradient-to-br{ max-width:92% !important; }

            footer{ padding:1.25rem 1rem; }
            footer p{ font-size:0.88rem; }
            footer a{ padding:0.7rem 1.25rem; font-size:0.95rem; }

            input:focus, button:focus { outline: 3px solid rgba(56,189,248,0.12); outline-offset:2px; }
        }

        @media (min-width:641px) and (max-width:900px){
            .blob-1, .blob-2{ filter: blur(70px); }
            .content-section.text-center h1{ font-size:2.2rem; }
            #view-chat { min-height:420px; }
        }
    </style>
</head>
<body class="min-h-screen antialiased">

    <div class="blob-cont">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>

    <div id="loading-overlay" class="fixed inset-0 flex items-center justify-center z-50 bg-[#0f172a] transition-opacity duration-500">
        <svg class="animate-spin w-16 h-16 text-sky-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><line x1="10" y1="9" x2="8" y2="9"></line></svg>
    </div>

    <!-- Header: centered, logo left of text -->
    <header class="fixed top-0 left-0 right-0 z-40 glass transition-all duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-20 flex items-center justify-center">
            <div class="flex items-center gap-3">
                <img src="mylogo.png" srcset="mylogo-1x.png 1x, mylogo-2x.png 2x" alt="Daily Dose logo" class="w-10 h-10 rounded-md object-contain shadow-md">
                <div class="text-2xl font-black tracking-tight text-white drop-shadow-lg text-center">
                    <div><span class="text-sky-400">Daily Dose of </span>BCA</div>
                </div>
            </div>
        </div>
    </header>

    <div class="pt-28 pb-12 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto min-h-screen flex flex-col">
        <!-- Hero -->
        <div class="content-section text-center mb-16">
            <h1 class="text-5xl md:text-7xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-white via-sky-100 to-sky-400 mb-6 drop-shadow-sm">
                Master Your SUBJECTS
            </h1>
            <p class="text-lg text-gray-300 max-w-2xl mx-auto font-light">
                Just get enough attendance; the rest I will take care of ‚Äî notes and exam preparation.
            </p>
        </div>

        <!-- Subject cards -->
        <div class="content-section grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-20" id="subject-cards-container">
            <a href="python.html" class="glass group block p-6 rounded-2xl transition-all duration-500 hover:bg-white/5 hover:border-sky-400/50 hover:shadow-[0_0_30px_rgba(56,189,248,0.2)] transform hover:-translate-y-2">
                <div class="flex flex-col h-full items-center">
                    <div class="w-12 h-12 rounded-lg bg-sky-500/10 flex items-center justify-center mb-4 group-hover:bg-sky-500/20 transition">
                        <svg class="w-6 h-6 text-sky-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg>
                    </div>
                    <h2 class="text-xl font-bold text-white mb-2 text-center">Python</h2>
                    <div class="mt-6 text-sky-400 text-sm font-bold flex items-center gap-2 group-hover:gap-3 transition-all">Open Notes <span>&rarr;</span></div>
                </div>
            </a>

            <a href="os.html" class="glass group block p-6 rounded-2xl transition-all duration-500 hover:bg-white/5 hover:border-sky-400/50 hover:shadow-[0_0_30px_rgba(56,189,248,0.2)] transform hover:-translate-y-2">
                <div class="flex flex-col h-full items-center">
                    <div class="w-12 h-12 rounded-lg bg-sky-500/10 flex items-center justify-center mb-4 group-hover:bg-sky-500/20 transition">
                        <svg class="w-6 h-6 text-sky-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg>
                    </div>
                    <h2 class="text-xl font-bold text-white mb-2 text-center">Operating System</h2>
                    <div class="mt-6 text-sky-400 text-sm font-bold flex items-center gap-2 group-hover:gap-3 transition-all">Open Notes <span>&rarr;</span></div>
                </div>
            </a>

            <a href="mad.html" class="glass group block p-6 rounded-2xl transition-all duration-500 hover:bg-white/5 hover:border-sky-400/50 hover:shadow-[0_0_30px_rgba(56,189,248,0.2)] transform hover:-translate-y-2">
                <div class="flex flex-col h-full items-center">
                    <div class="w-12 h-12 rounded-lg bg-sky-500/10 flex items-center justify-center mb-4 group-hover:bg-sky-500/20 transition">
                        <svg class="w-6 h-6 text-sky-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"></path><line x1="4" y1="22" x2="4" y2="15"></line></svg>
                    </div>
                    <h2 class="text-xl font-bold text-white mb-2 text-center">MAD</h2>
                    <div class="mt-6 text-sky-400 text-sm font-bold flex items-center gap-2 group-hover:gap-3 transition-all">Open Notes <span>&rarr;</span></div>
                </div>
            </a>

            <a href="afm.html" class="glass group block p-6 rounded-2xl transition-all duration-500 hover:bg-white/5 hover:border-sky-400/50 hover:shadow-[0_0_30px_rgba(56,189,248,0.2)] transform hover:-translate-y-2">
                <div class="flex flex-col h-full items-center">
                    <div class="w-12 h-12 rounded-lg bg-sky-500/10 flex items-center justify-center mb-4 group-hover:bg-sky-500/20 transition">
                        <svg class="w-6 h-6 text-sky-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
                    </div>
                    <h2 class="text-xl font-bold text-white mb-2 text-center">AFM</h2>
                    <div class="mt-6 text-sky-400 text-sm font-bold flex items-center gap-2 group-hover:gap-3 transition-all">Open Notes <span>&rarr;</span></div>
                </div>
            </a>

            <a href="seo.html" class="glass group block p-6 rounded-2xl transition-all duration-500 hover:bg-white/5 hover:border-sky-400/50 hover:shadow-[0_0_30px_rgba(56,189,248,0.2)] transform hover:-translate-y-2">
                <div class="flex flex-col h-full items-center">
                    <div class="w-12 h-12 rounded-lg bg-sky-500/10 flex items-center justify-center mb-4 group-hover:bg-sky-500/20 transition">
                        <svg class="w-6 h-6 text-sky-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
                    </div>
                    <h2 class="text-xl font-bold text-white mb-2 text-center">SEO</h2>
                    <div class="mt-6 text-sky-400 text-sm font-bold flex items-center gap-2 group-hover:gap-3 transition-all">Open Notes <span>&rarr;</span></div>
                </div>
            </a>

            <a href="tc.html" class="glass group block p-6 rounded-2xl transition-all duration-500 hover:bg-white/5 hover:border-sky-400/50 hover:shadow-[0_0_30px_rgba(56,189,248,0.2)] transform hover:-translate-y-2">
                <div class="flex flex-col h-full items-center">
                    <div class="w-12 h-12 rounded-lg bg-sky-500/10 flex items-center justify-center mb-4 group-hover:bg-sky-500/20 transition">
                        <svg class="w-6 h-6 text-sky-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
                    </div>
                    <h2 class="text-xl font-bold text-white mb-2 text-center">TC</h2>
                    <div class="mt-6 text-sky-400 text-sm font-bold flex items-center gap-2 group-hover:gap-3 transition-all">Open Notes <span>&rarr;</span></div>
                </div>
            </a>

            <a href="nano.html" class="glass group block p-6 rounded-2xl transition-all duration-500 hover:bg-white/5 hover:border-sky-400/50 hover:shadow-[0_0_30px_rgba(56,189,248,0.2)] transform hover:-translate-y-2">
                <div class="flex flex-col h-full items-center">
                    <div class="w-12 h-12 rounded-lg bg-sky-500/10 flex items-center justify-center mb-4 group-hover:bg-sky-500/20 transition">
                        <svg class="w-6 h-6 text-sky-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
                    </div>
                    <h2 class="text-xl font-bold text-white mb-2 text-center">Nano</h2>
                    <div class="mt-6 text-sky-400 text-sm font-bold flex items-center gap-2 group-hover:gap-3 transition-all">Open Notes <span>&rarr;</span></div>
                </div>
            </a>
        </div>

        <!-- AI study companion -->
        <div class="content-section max-w-5xl mx-auto glass-strong rounded-3xl shadow-2xl relative overflow-hidden mb-20">
            <div class="p-6 border-b border-white/10 flex flex-col sm:flex-row justify-between items-center gap-4">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 rounded-full bg-gradient-to-br from-sky-400 to-blue-600 flex items-center justify-center shadow-lg shadow-sky-900/50">
                        <span class="text-2xl">‚ú®</span>
                    </div>
                    <div>
                        <h2 class="text-xl font-bold text-white">AI Study Companion</h2>
                        <p class="text-xs text-sky-300 font-medium">Powered by Waheed</p>
                    </div>
                </div>

                <div class="flex bg-black/20 p-1 rounded-xl">
                    <button onclick="switchTab('quick')" id="tab-quick" class="px-6 py-2 rounded-lg text-sm font-bold transition-all duration-300 bg-white/10 text-white shadow-sm">Quick Tools</button>
                    <button onclick="switchTab('chat')" id="tab-chat" class="px-6 py-2 rounded-lg text-sm font-bold transition-all duration-300 text-gray-400 hover:text-white">Chat</button>
                </div>
            </div>

            <div class="p-6 min-h-[400px]">
                <div id="view-quick" class="animate-fade-in">
                    <div class="max-w-3xl mx-auto">
                        <label class="block text-sm font-medium text-sky-100 mb-3 ml-1">Type anything below and click any of 3 buttons below.</label>
                        <input type="text" id="quick-topic" placeholder="e.g. Python, How to make a website..." 
                            class="w-full p-4 bg-black/30 border border-white/10 rounded-2xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-sky-500/50 focus:border-sky-500/50 transition-all text-lg mb-8 backdrop-blur-sm">

                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-8">
                            <button onclick="triggerQuickTask('explain')" class="p-5 bg-white/5 hover:bg-white/10 border border-white/5 hover:border-sky-400/30 rounded-2xl text-left group transition-all duration-300 hover:-translate-y-1">
                                <div class="text-2xl mb-2 p-2 bg-sky-500/10 rounded-lg w-fit">üìù</div>
                                <h3 class="font-bold text-white">Explain</h3>
                                <p class="text-xs text-gray-400 mt-1 group-hover:text-sky-200">Clear, concise notes.</p>
                            </button>
                            <button onclick="triggerQuickTask('quiz')" class="p-5 bg-white/5 hover:bg-white/10 border border-white/5 hover:border-sky-400/30 rounded-2xl text-left group transition-all duration-300 hover:-translate-y-1">
                                <div class="text-2xl mb-2 p-2 bg-sky-500/10 rounded-lg w-fit">‚ùì</div>
                                <h3 class="font-bold text-white">Quiz Me</h3>
                                <p class="text-xs text-gray-400 mt-1 group-hover:text-sky-200">Test your knowledge.</p>
                            </button>
                            <button onclick="triggerQuickTask('plan')" class="p-5 bg-white/5 hover:bg-white/10 border border-white/5 hover:border-sky-400/30 rounded-2xl text-left group transition-all duration-300 hover:-translate-y-1">
                                <div class="text-2xl mb-2 p-2 bg-sky-500/10 rounded-lg w-fit">üìÖ</div>
                                <h3 class="font-bold text-white">Study Plan</h3>
                                <p class="text-xs text-gray-400 mt-1 group-hover:text-sky-200">1-week roadmap.</p>
                            </button>
                        </div>

                        <div id="quick-result-area" class="hidden bg-black/40 border border-white/10 rounded-2xl p-6 backdrop-blur-sm">
                            <div class="flex justify-between items-center mb-4 border-b border-white/10 pb-2">
                                <h3 id="quick-result-title" class="font-bold text-white">Result</h3>
                                <button onclick="closeQuickResult()" class="text-gray-400 hover:text-white text-sm">&times;</button>
                            </div>
                            <div id="quick-loading" class="hidden flex items-center justify-center py-8">
                                <svg class="animate-spin h-6 w-6 text-sky-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle class="opacity-25" cx="12" cy="12" r="10"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                            </div>
                            <div id="quick-response" class="prose prose-invert prose-sm max-w-none text-gray-200"></div>
                        </div>
                    </div>
                </div>

                <div id="view-chat" class="hidden h-[500px] flex flex-col relative animate-fade-in">
                    <div class="absolute top-0 right-0 z-10">
                         <button onclick="clearChatHistory()" class="text-[10px] uppercase tracking-wider text-red-300 hover:text-white bg-red-500/10 px-2 py-1 rounded hover:bg-red-500/30 transition">Clear History</button>
                    </div>

                    <div id="doc-indicator" class="hidden absolute top-0 left-0 right-0 z-20 bg-sky-600/20 border border-sky-500/30 rounded-lg px-4 py-2 flex justify-between items-center backdrop-blur-md mx-1 mt-1">
                        <div class="flex items-center gap-2 text-xs text-sky-100">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                            <span id="doc-name" class="font-bold truncate max-w-[150px]">Document.pdf</span>
                            <span class="text-sky-300 opacity-75 text-[10px] tracking-wide uppercase">Reading active</span>
                        </div>
                        <button onclick="clearDocument()" class="text-sky-300 hover:text-white hover:bg-sky-500/20 rounded p-1 transition">&times;</button>
                    </div>

                    <div id="chat-history" class="flex-grow overflow-y-auto custom-scrollbar pr-2 mb-4 space-y-4 pt-10">
                        <div class="flex justify-start">
                            <div class="glass text-gray-100 p-4 rounded-2xl rounded-tl-none max-w-[85%] shadow-sm border-white/5 text-sm">
                                Hi! I'm your AI Tutor. Upload a PDF to analyze it, or just ask me anything!
                            </div>
                        </div>
                    </div>

                    <div class="mt-auto relative flex items-center gap-3 p-1">
                        <input type="file" id="file-upload" class="hidden" accept=".txt,.pdf,.md" onchange="handleFileUpload(this)">
                        <button onclick="document.getElementById('file-upload').click()" class="p-3 rounded-full bg-white/5 hover:bg-white/10 text-gray-300 hover:text-sky-300 transition border border-white/5" title="Upload Document">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"></path></svg>
                        </button>

                        <div class="relative flex-grow">
                            <input type="text" id="chat-input" placeholder="Type your message..." 
                                class="w-full pl-5 pr-12 py-3 bg-black/30 border border-white/10 rounded-full text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-sky-500/50 backdrop-blur-sm transition shadow-inner"
                                onkeydown="if(event.key === 'Enter') handleChatSend()">
                            <button onclick="handleChatSend()" class="absolute right-2 top-2 p-1.5 bg-sky-500 hover:bg-sky-400 text-white rounded-full transition shadow-lg shadow-sky-900/50">
                                <svg class="w-5 h-5 transform rotate-90" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19V5m0 0l-7 7m7-7l7 7"></path></svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Action buttons (moved from header) -->
        <div class="max-w-5xl mx-auto my-6 flex flex-col sm:flex-row items-center justify-center gap-4 px-4">
            <a href="4assign.html" class="w-full sm:w-auto flex items-center gap-3 justify-center py-3 px-6 bg-white/5 border border-white/10 rounded-2xl hover:bg-white/10 transition shadow-sm">
                <svg class="w-5 h-5 text-sky-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg>
                <span class="text-sm font-semibold text-white">Assignments</span>
            </a>

            <a href="4record.html" class="w-full sm:w-auto flex items-center gap-3 justify-center py-3 px-6 bg-gradient-to-r from-sky-500 to-blue-600 text-white font-bold rounded-2xl hover:scale-[1.02] transition shadow-lg">
                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                <span class="text-sm font-semibold">Record Work</span>
            </a>
        </div>

        <!-- Footer -->
        <footer class="mt-auto py-8 border-t border-white/10 text-center relative z-10">
            <p class="text-gray-400 mb-6 text-sm font-light">Get personalised class chatbot, class materials encrafted especially for you.</p>
            <a href="exclusive.html" class="inline-block py-3 px-10 bg-gradient-to-r from-sky-500 to-blue-600 text-white font-bold rounded-full shadow-lg shadow-sky-500/30 hover:shadow-sky-500/50 hover:scale-105 transition-all duration-300">
                Premium Content
            </a>
            <p class="text-gray-600 mt-8 text-xs">&copy; 2024 Learning Hub. All rights reserved (Maybe).</p>
        </footer>
    </div>

    <div id="message-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black/80 backdrop-blur-sm">
        <div class="glass-strong p-6 rounded-2xl max-w-sm w-full mx-4 shadow-2xl border border-white/10">
            <h3 class="text-xl font-bold text-white mb-2">Notice</h3>
            <p id="modal-text" class="text-gray-300 mb-6 text-sm"></p>
            <button onclick="closeModal()" class="w-full py-2 bg-sky-600 hover:bg-sky-500 text-white rounded-xl font-semibold transition">Okay</button>
        </div>
    </div>

    <script>
    // === CONFIG ===
    const apiKey = "AIzaSyAUdAKZk8LrXjcalIFnNYoK28uzJJ9OvEM"; // replace with real key if needed

    // === BOOT / UI INIT ===
    document.addEventListener('DOMContentLoaded', () => {
        setTimeout(() => {
            const loader = document.getElementById('loading-overlay');
            if(loader){ loader.style.opacity = '0'; setTimeout(()=>{ loader.style.display = 'none'; initScroll(); }, 500); }
        }, 800);
        loadChatHistory();

        // default to quick tools on small screens
        if(window.innerWidth <= 640) switchTab('quick');
    });

    function initScroll(){
        const observer = new IntersectionObserver((entries)=>{
            entries.forEach(entry => { if(entry.isIntersecting) entry.target.classList.add('is-visible'); });
        }, { threshold: 0.1 });
        document.querySelectorAll('.content-section').forEach(s => observer.observe(s));
    }

    // === TABS ===
    function switchTab(tab){
        const quick = document.getElementById('view-quick');
        const chat = document.getElementById('view-chat');
        const bQuick = document.getElementById('tab-quick');
        const bChat = document.getElementById('tab-chat');

        if(tab === 'quick'){
            quick.classList.remove('hidden');
            chat.classList.add('hidden');
            bQuick.classList.add('bg-white/10','text-white','shadow-sm'); bQuick.classList.remove('text-gray-400');
            bChat.classList.remove('bg-white/10','text-white','shadow-sm'); bChat.classList.add('text-gray-400');
        } else {
            quick.classList.add('hidden');
            chat.classList.remove('hidden');
            bChat.classList.add('bg-white/10','text-white','shadow-sm'); bChat.classList.remove('text-gray-400');
            bQuick.classList.remove('bg-white/10','text-white','shadow-sm'); bQuick.classList.add('text-gray-400');
            const container = document.getElementById('chat-history');
            if(container) container.scrollTop = container.scrollHeight;
        }
    }

    // === MODAL ===
    const modal = document.getElementById('message-modal');
    const mText = document.getElementById('modal-text');
    function showModal(txt){ if(mText) mText.textContent = txt; if(modal) modal.classList.remove('hidden'); }
    function closeModal(){ if(modal) modal.classList.add('hidden'); }

    // === FILE UPLOAD ===
    let currentDocContext = "";
    async function handleFileUpload(input){
        const file = input.files?.[0];
        if(!file) return;
        showModal(`Processing ${file.name}...`);
        try{
            let text = "";
            if(file.type === "application/pdf") text = await readPDF(file);
            else text = await file.text();

            if(text.length > 50000) text = text.substring(0,50000) + "...[truncated]";
            currentDocContext = text;

            const docIndicator = document.getElementById('doc-indicator');
            if(docIndicator) docIndicator.classList.remove('hidden');
            const docName = document.getElementById('doc-name');
            if(docName) docName.textContent = file.name;
            closeModal();
            appendMessage('ai', `I've analyzed **${file.name}**. Ask me anything about it!`, false);
        } catch(e){
            console.error(e);
            closeModal();
            showModal("Error reading file.");
        }
        // reset input
        input.value = '';
    }

    async function readPDF(file){
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
        let fullText = "";
        for(let i=1; i<=pdf.numPages; i++){
            const page = await pdf.getPage(i);
            const content = await page.getTextContent();
            fullText += content.items.map(item => item.str).join(' ') + "\n";
        }
        return fullText;
    }

    function clearDocument(){
        currentDocContext = "";
        const docIndicator = document.getElementById('doc-indicator');
        if(docIndicator) docIndicator.classList.add('hidden');
    }

    // === CHAT HISTORY ===
    let chatHistory = [];
    function loadChatHistory(){
        try{
            const saved = localStorage.getItem('glass_chat_v1');
            if(saved){
                chatHistory = JSON.parse(saved);
                const container = document.getElementById('chat-history');
                if(chatHistory.length && container) container.innerHTML = '';
                chatHistory.forEach(m => appendMessage(m.role, m.text, false));
            }
        }catch(e){ console.error('loadChatHistory', e); }
    }

    function clearChatHistory(){
        localStorage.removeItem('glass_chat_v1');
        chatHistory = [];
        const container = document.getElementById('chat-history');
        if(container) container.innerHTML = `<div class="flex justify-start"><div class="glass text-gray-100 p-4 rounded-2xl rounded-tl-none max-w-[85%] shadow-sm border-white/5 text-sm">History cleared.</div></div>`;
    }

    // === SEND / RECEIVE ===
    async function handleChatSend(){
        const input = document.getElementById('chat-input');
        if(!input) return;
        const msg = input.value.trim();
        if(!msg) return;
        appendMessage('user', msg, true);
        input.value = '';

        const container = document.getElementById('chat-history');
        const loaderId = 'load-'+Date.now();
        if(container) {
            container.insertAdjacentHTML('beforeend', `<div id="${loaderId}" class="flex justify-start"><div class="glass p-4 rounded-2xl rounded-tl-none text-gray-400 text-sm"><span class="animate-pulse">Thinking...</span></div></div>`);
            container.scrollTop = container.scrollHeight;
        }

        try{
            // Prepare payload from chatHistory
            let apiMsgs = chatHistory.map(m => ({ role: m.role === 'user' ? 'user' : 'model', parts:[{text: m.text}] }));
            // add context if doc present
            if(currentDocContext && apiMsgs.length){
                const last = apiMsgs[apiMsgs.length-1];
                if(last && last.role === 'user'){
                    last.parts[0].text = `CONTEXT:\n${currentDocContext}\n\nQUESTION:\n${last.parts[0].text}`;
                }
            }

            const reply = await callGemini(apiMsgs);
            const loaderEl = document.getElementById(loaderId);
            if(loaderEl) loaderEl.remove();
            appendMessage('ai', reply, true);
        } catch(e){
            const loaderEl = document.getElementById(loaderId);
            if(loaderEl) loaderEl.remove();
            appendMessage('ai', "Connection error.", false);
            console.error(e);
        }
    }

    function appendMessage(role, text, save){
        const container = document.getElementById('chat-history');
        if(!container) return;
        const div = document.createElement('div');
        div.className = `flex ${role === 'user' ? 'justify-end' : 'justify-start'}`;

        const bubbleClass = role === 'user'
            ? 'bg-gradient-to-br from-sky-500 to-blue-600 text-white p-4 rounded-2xl rounded-tr-none max-w-[85%] shadow-lg text-sm'
            : 'glass text-gray-100 p-4 rounded-2xl rounded-tl-none max-w-[85%] shadow-sm border-white/5 text-sm prose prose-invert prose-sm';

        div.innerHTML = `<div class="${bubbleClass}">${role === 'user' ? escapeHtml(text) : marked.parse(text)}</div>`;
        container.appendChild(div);
        container.scrollTop = container.scrollHeight;

        if(save){
            chatHistory.push({ role, text });
            try{ localStorage.setItem('glass_chat_v1', JSON.stringify(chatHistory)); }catch(e){ console.error(e); }
        }
    }

    // small HTML escape for user bubble (prevents raw HTML injection)
    function escapeHtml(unsafe){
        return unsafe.replace(/[&<"'>]/g, function(m){
            return ({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[m];
        });
    }

    // === QUICK TOOLS ===
    async function triggerQuickTask(type){
        const topicEl = document.getElementById('quick-topic');
        const topic = topicEl?.value?.trim();
        if(!topic){ showModal("Please enter a topic."); return; }

        document.getElementById('quick-result-area').classList.remove('hidden');
        const loading = document.getElementById('quick-loading');
        loading.classList.remove('hidden'); loading.classList.add('flex');
        document.getElementById('quick-response').innerHTML = '';

        let prompt = "";
        if(type === 'explain') prompt = `Explain "${topic}" simply. Bold key terms.`;
        else if(type === 'quiz') prompt = `3 multiple choice questions on "${topic}". Answers at bottom.`;
        else prompt = `1-week study plan for "${topic}". Bullet points.`;

        try{
            const res = await callGemini([{ role:'user', parts:[{text: prompt}] }]);
            loading.classList.add('hidden'); loading.classList.remove('flex');
            document.getElementById('quick-response').innerHTML = marked.parse(res);
        }catch(e){
            loading.classList.add('hidden');
            document.getElementById('quick-response').innerHTML = "Error.";
            console.error(e);
        }
    }
    function closeQuickResult(){ document.getElementById('quick-result-area').classList.add('hidden'); }

    // === CALL GEMINI (Google Generative Language) ===
    // NOTE: Replace apiKey above with your key. The endpoint and request shape below match the earlier implementation.
    async function callGemini(payload){
        if(!apiKey || apiKey === "AIzaSyAUdAKZk8LrXjcalIFnNYoK28uzJJ9OvEM"){
            // fallback: mock response when API key absent (keeps UI functional)
            console.warn('No API key provided for Gemini; returning local mock reply.');
            return "This is a mock reply because no API key is set. Replace the placeholder with a valid API key to enable live responses.";
        }

        const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
        const body = { contents: payload };
        const res = await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(body)
        });
        if(!res.ok) {
            const txt = await res.text().catch(()=>null);
            throw new Error('API error: '+res.status + ' ' + txt);
        }
        const data = await res.json();
        return data.candidates?.[0]?.content?.parts?.[0]?.text || "No response.";
    }

    </script>
</body>
</html>
